(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/submit"],{2849:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o("2f62");function n(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,r)}return o}function i(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?n(Object(o),!0).forEach((function(e){a(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function a(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var u=function(){o.e("components/t-pay-way/ti-pay-way").then(function(){return resolve(o("d8ca"))}.bind(null,o)).catch(o.oe)},s={components:{tPayWay:u},computed:i({},(0,r.mapState)(["modalAction"])),data:function(){return{hasCoupon:!1,insufficient:!1,show:!1,listData:{},goods:{},remark:"",payInfo:"",credit:0,addressData:""}},onLoad:function(){this.getList()},methods:{getList:function(){var t=this,e={};this.$Route.query.goodsid&&(e.id=this.$Route.query.goodsid||!1),this.$Route.query.total&&(e.total=this.$Route.query.total||1),this.$Route.query.optionid&&(e.optionid=this.$Route.query.optionid),this.$http.get("order.create",e).then((function(e){t.listData=e,t.goods=e.goods,t.addressData=e.address}))},chooseAddrCallback:function(t){this.addressData=t},submit:function(){var t=this;if(this.addressData.id){var e={goods:this.goods[0]["goods"],addressid:this.addressData.id,remark:this.remark,hasinvoice:!1};this.$Route.query.goodsid||(e.fromcart=1),this.$http.post("order.create.submit",e).then((function(e){0==e.error&&t.actionPay(e.orderid)}))}else this.$utils.toast("请选择收货地址")},payment:function(t){var e=this;switch(t.type){case"credit":this.$http.get("order.pay.complete",{id:this.payInfo.order.id,type:t.type}).then((function(t){0==t.error?(e.$utils.toast("支付成功"),e.show=!1,e.$Router.push({path:"/pages/order/pay/result",query:{type:"order",orderid:e.payInfo.order.id}})):e.$utils.toast("支付出错")}));break;case"wechat":this.$utils.weixinPay(this.payInfo.wechat.payinfo).then((function(t){!1!==t&&e.$utils.toast("支付成功"),e.show=!1,!1!==t?e.$Router.push({path:"/pages/order/pay/result",query:{type:"order",orderid:e.payInfo.order.id}}):setTimeout((function(){e.$Router.push({path:"/pages/order/detail",query:{id:e.payInfo.order.id,listener:!0}})}),1500)})).catch((function(t){e.$utils.toast("支付失败")}));break;default:return void this.$utils.toast("请先选择支付方式")}},actionPay:function(t){var e=this;this.$http.get("order.pay",{id:t}).then((function(t){e.payInfo=t,e.credit=parseInt(t.credit.current),e.show=!0}))},popupClose:function(){var t=this;this.$utils.modal.confirm("确定取消支付吗？").then((function(e){t.show=!1}))}}};e.default=s},"575f":function(t,e,o){"use strict";o.d(e,"b",(function(){return n})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){return r}));var r={tuiListCell:function(){return o.e("components/thorui/tui-list-cell/tui-list-cell").then(o.bind(null,"d016"))},tuiButton:function(){return o.e("components/thorui/tui-button/tui-button").then(o.bind(null,"7133"))},uModal:function(){return o.e("node-modules/uview-ui/components/u-modal/u-modal").then(o.bind(null,"5a91"))}},n=function(){var t=this,e=t.$createElement,o=(t._self._c,(t.listData.realprice||"").toString().split(".")),r=(t.listData.realprice||"").toString().split("."),n=(t.listData.realprice||"").toString().split("."),i=(t.listData.realprice||"").toString().split(".");t._isMounted||(t.e0=function(e){return t.$Router.push({name:"address_index"})},t.e1=function(e){return t.modalAction.confirmCallback(!0)}),t.$mp.data=Object.assign({},{$root:{g0:o,g1:r,g2:n,g3:i}})},i=[]},7852:function(t,e,o){"use strict";o.r(e);var r=o("2849"),n=o.n(r);for(var i in r)"default"!==i&&function(t){o.d(e,t,(function(){return r[t]}))}(i);e["default"]=n.a},"8a73":function(t,e,o){},"9ea1":function(t,e,o){"use strict";var r=o("8a73"),n=o.n(r);n.a},e855:function(t,e,o){"use strict";o.r(e);var r=o("575f"),n=o("7852");for(var i in n)"default"!==i&&function(t){o.d(e,t,(function(){return n[t]}))}(i);o("9ea1");var a,u=o("f0c5"),s=Object(u["a"])(n["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],a);e["default"]=s.exports},eac7:function(t,e,o){"use strict";(function(t){o("57ba");r(o("66fd"));var e=r(o("e855"));function r(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])}},[["eac7","common/runtime","common/vendor"]]]);